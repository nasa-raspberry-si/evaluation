sequenceDiagram
        participant TH
        participant TA

	Note right of TA: setting up, activity on any endpoint is an error

        TA ->>+ TH: /ready
        TH -->>- TA: configuration data

        TA ->>+ TH: /status live
        Note right of TA: system live, ready for initial perturbs
        TH -->>- TA: ack. status

        opt initial perturbs
            opt for any X
                 TH ->>+ TA: /perturb/X
                 TA -->>- TH: ack. /perturb/X
            end
        end

        TH ->>+ TA: /start
        TA -->>- TH: ack. start
        Note right of TA: starting may take time, so this ack does not mean that the bot is moving

	loop as desired
	     Note left of TH: interleave below, upto /done
	     TH ->>+ TA: /observe
	     TA -->>- TH: observation
	end

        TA ->>+ TH: /status mission-running
	Note right of TA: SUT has processes initial perturbs and started mission. after /start, no dynmaic perturbs are allowed until this message
        TH -->>- TA: ack. status

        Note left of TH: may be interleaved with dynamic perturbs, but not inside an individual one
        loop as desired
                opt dynamic perturbs
                            opt for any X
                                 TH ->>+ TA: /perturb/X
                                 TA -->>- TH: ack. /perturb/X
                            end
                end

                opt as needed
                    TA ->>+ TH: /status adapting
                    TH -->>- TA: ack. status

		    Note right of TA: no dynamic perturbs allowed between these two statuses

                    TA ->>+ TH: /status adapted
                    TH -->>- TA: ack. status
                end
        end

        Note right of TA: won't send until the mission is over and all logs cleaned up
        TA ->> TH: /done
        TH -->> TA: ack. /done

        Note left of TH: TH may shutdown before this is processed
