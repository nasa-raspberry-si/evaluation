sequenceDiagram
	participant TH
	participant TA

	Note right of TA: setting up, activity on any endpoint is an error

	TA ->>+ TH: /ready
	TH -->>- TA: configuration data

	loop as desired
	     Note left of TH: interleave below, upto /done
	     TH ->>+ TA: /observe
	     TA -->>- TH: observation
	end

	TH ->>+ TA: /perturbations
	TA -->>- TH: all possible perturbations

	Note right of TA: some perturbations are neutral
	loop until get 204 reply
		TH ->>+ TA: /perturb
		TA -->>- TH: ack. perturbed
	end

	opt in adaptive case
	     TH ->> TA: /adapt
	     loop periodical
	     	  TA ->>+ TH: /status
		  TH -->>- TA: ack. status
	     end
	end

        Note right of TA: won't send until validation is over and all logs cleaned up
        TA ->> TH: /done
        TH -->> TA: ack. /done
        Note left of TH: TH may shutdown before this is processed
