swagger: '2.0'
info:
  version: '0.1'
  title: 'cmu mars brass ta: phase 2, cp1'
schemes:
  - http
host: brass-ta
paths:
  /perturb/place-obstacle:
    post:
      description: >-
        if the test is running, then place an instance of the obstacle on
        the map
      parameters:
        - in: body
          name: PlaceParams
          schema:
            type: object
            required:
              - x
              - 'y'
            properties:
              x:
                type: number
                format: float
                description: >-
                  the x-coordinate of the center of the obstacle placement
                  position
              'y':
                type: number
                format: float
                description: >-
                  the y-coordinate of the center of the obstacle placement
                  position
      responses:
        '200':
          description: the obstacle has been placed in the running test
          schema:
            type: object
            required:
              - obstacleid
              - sim-time
            properties:
              obstacleid:
                type: string
                description: >-
                  a unique identifier for this particular placed obstacle, so
                  that it can be removed in the future
              sim-time:
                type: integer
                description: the simulation time when the obstacle was placed
        '400':
          description: an error was encountered while placing the obstacle.
          schema:
            type: object
            required:
              - cause
              - message
            properties:
              cause:
                description: a reason for the error condition
                type: string
                enum:
                  - bad-coordiantes
                  - other-error
              message:
                type: string
                description: human readable info about what went wrong
  /perturb/remove-obstacle:
    post:
      description: >-
        if the test is running, remove a previously placed obstacle from
        the map
      parameters:
        - in: body
          name: RemoveParams
          schema:
            type: object
            required:
              - obstacleid
            properties:
              obstacleid:
                type: string
                description: >-
                  the obstacle ID given by /perturb/place-obstacle of the
                  obstacle to be removed.
      responses:
        '200':
          description: the obstacle has been removed from the running test
          schema:
            type: object
            required:
              - sim-time
            properties:
              sim-time:
                type: integer
                description: the simulation time when the obstacle was placed
        '400':
          description: an error was encountered while removing the obstacle.
          schema:
            type: object
            required:
              - cause
              - message
            properties:
              cause:
                description: >-
                  a reason for the error condition. `bad-obstacleid` is
                  used if this endpoint is given a obstacleid in its
                  parameters that was not given out by place-obstacle;
                  `other-error` is used in all other instances.
                type: string
                enum:
                  - bad-obstacleid
                  - other-error
              message:
                type: string
                description: human readable info about what went wrong
  /perturb/battery:
    post:
      description: >-
        set the level of the battery in a currently running
        test. consistent with the monotonicity requirement for the power
        model, this cannot be more than the current amount of charge in the
        battery.
      parameters:
        - in: body
          name: BatteryParams
          schema:
            type: object
            required:
              - charge
            properties:
              charge:
                type: number
                minimum: 0
                description: >-
                  the level to which the battery should be set, in
                  mWh. cannot be more than the maximum charge for the power
                  model specified in the THs response to `/ready`.
      responses:
        '200':
          description: the battery has been set to the requested level
          schema:
            type: object
            required:
              - sim-time
            properties:
              sim-time:
                type: integer
                description: the simulation time when the battery was set
        '400':
          description: an error was encountered while setting the battery
          schema:
            type: object
            required:
              - message
            properties:
              message:
                type: string
                description: human readable info about what went wrong
  /start:
    post:
      description: start the turtlebot on the mission
      responses:
        '200':
          description: successfully started the mission
        '400':
          description: encountered an error in starting the mission
          schema:
            type: object
            properties:
              message:
                type: string
                description: >-
                  human readable information about the error, if any can be
                  provided
  /observe:
    get:
      description: >-
        observe some of the current state of the robot for visualization
        and invariant checking for perturbation end points. n.b. this
        information is to be used strictly in a passive way; it is not to
        be used for evaluation of the test at all.
      responses:
        '200':
          description: >-
            successfully computed the observation
          schema:
            type: object
            required:
              - x
              - 'y'
              - battery
              - sim-time
            properties:
              x:
                type: number
                format: float
                description: >-
                  the current x coordinate of the bot. must be within the
                  boundaries of the map.
              y:
                type: number
                format: float
                description: >-
                  the current y coordinate of the bot. must be within the
                  boundaries of the map.
              battery:
                type: integer
                minimum: 0
                description: >-
                  the current charge of the battery, in mWh
              sim-time:
                type: integer
                minimum: 0
                description: >-
                  the time when this observation was computed, in
                  simulation seconds
        '400':
          description: >-
            encountered an error while computing the observation
